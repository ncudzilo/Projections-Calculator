<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practice Scalability Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { brand: '#f8cc74' }
                }
            }
        }
    </script>
    <style>
        body { background-color: #0f1115; color: #f3f4f6; font-family: sans-serif; }
        .stat-card { background: #1a1d23; border: 1px solid #2d3139; border-radius: 1rem; padding: 1.5rem; }
        input { background: #0f1115 !important; border: 1px solid #374151 !important; color: #f8cc74 !important; }
        input:focus { border-color: #f8cc74 !important; outline: none; }
        .tooltip-box { display: none; position: absolute; background: #000; color: #fff; padding: 5px 10px; border-radius: 4px; font-size: 11px; width: 150px; z-index: 100; border: 1px solid #f8cc74; }
        .has-tooltip:hover .tooltip-box { display: block; }
    </style>
</head>
<body class="p-4 md:p-12">

    <div class="max-w-6xl mx-auto">
        <header class="mb-10 border-l-4 border-brand pl-6">
            <h1 class="text-3xl font-black uppercase italic tracking-tighter">Scalability <span class="text-brand">Engine</span></h1>
            <p class="text-gray-500 text-sm">3-Year Growth & Revenue Projection</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <div class="lg:col-span-4 bg-[#1a1d23] p-6 rounded-3xl border border-gray-800 h-fit space-y-5">
                <h2 class="text-brand text-[10px] font-bold uppercase tracking-widest mb-4">Live Configuration</h2>
                
                <div>
                    <label class="block text-[10px] text-gray-500 font-bold uppercase mb-1 has-tooltip relative">
                        New Patients / Month ⓘ
                        <span class="tooltip-box">How many new patients you sign up every single month.</span>
                    </label>
                    <input type="number" id="growth" value="30" class="w-full p-3 rounded-xl font-mono">
                </div>

                <div>
                    <label class="block text-[10px] text-gray-500 font-bold uppercase mb-1">Monthly Subscription ($)</label>
                    <input type="number" id="fee" value="90" class="w-full p-3 rounded-xl font-mono">
                </div>

                <div>
                    <label class="block text-[10px] text-gray-500 font-bold uppercase mb-1 has-tooltip relative">
                        One-Time Program Fee ($) ⓘ
                        <span class="tooltip-box">Upfront cost paid by new patients in their first month.</span>
                    </label>
                    <input type="number" id="setupFee" value="500" class="w-full p-3 rounded-xl font-mono">
                </div>

                <div>
                    <label class="block text-[10px] text-gray-500 font-bold uppercase mb-1">Hours / Patient / Quarter</label>
                    <input type="number" id="hours" value="1" step="0.5" class="w-full p-3 rounded-xl font-mono">
                </div>

                <div>
                    <label class="block text-[10px] text-gray-500 font-bold uppercase mb-1">Max Weekly Hours Limit</label>
                    <input type="number" id="maxHours" value="40" class="w-full p-3 rounded-xl font-mono">
                </div>
            </div>

            <div class="lg:col-span-8 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="stat-card">
                        <p class="text-[9px] text-gray-500 uppercase font-black mb-1">Effective Hourly Rate</p>
                        <p id="stat-hourly" class="text-2xl font-bold text-white tracking-tighter">$0</p>
                    </div>
                    <div class="stat-card">
                        <p class="text-[9px] text-gray-500 uppercase font-black mb-1">Max Patient Capacity</p>
                        <p id="stat-capacity" class="text-2xl font-bold text-white tracking-tighter">0</p>
                    </div>
                    <div class="stat-card border-b-brand/40 border-b-2">
                        <p class="text-[9px] text-gray-500 uppercase font-black mb-1">Year 3 Monthly Rev</p>
                        <p id="stat-revenue" class="text-2xl font-bold text-white tracking-tighter">$0</p>
                    </div>
                </div>

                <div class="bg-[#1a1d23] p-6 rounded-3xl border border-gray-800 shadow-2xl h-[400px]">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ctx = document.getElementById('revenueChart').getContext('2d');
        let chart;

        function calculate() {
            const growth = parseFloat(document.getElementById('growth').value) || 0;
            const fee = parseFloat(document.getElementById('fee').value) || 0;
            const setupFee = parseFloat(document.getElementById('setupFee').value) || 0;
            const hours = parseFloat(document.getElementById('hours').value) || 1;
            const maxHours = parseFloat(document.getElementById('maxHours').value) || 40;

            const labels = [];
            const revenueData = [];
            let totalPatients = 0;

            for (let i = 1; i <= 36; i++) {
                totalPatients += growth;
                const recurring = totalPatients * fee;
                const oneTime = growth * setupFee;
                const monthlyTotal = recurring + oneTime;
                
                labels.push('M' + i);
                revenueData.push(monthlyTotal);
            }

            // Stats
            const capacity = Math.floor((maxHours * 4.33 * 3) / hours);
            const hourlyRate = (fee * 3) / hours;
            const year3Rev = revenueData[35];

            document.getElementById('stat-hourly').innerText = '$' + Math.round(hourlyRate);
            document.getElementById('stat-capacity').innerText = capacity.toLocaleString();
            document.getElementById('stat-revenue').innerText = '$' + Math.round(year3Rev).toLocaleString();

            updateChart(labels, revenueData);
        }

        function updateChart(labels, data) {
            if (chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Monthly Revenue ($)',
                        data: data,
                        borderColor: '#f8cc74',
                        backgroundColor: 'rgba(248, 204, 116, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { 
                            grid: { color: '#2d3139' },
                            ticks: { color: '#4b5563', callback: v => '$' + v/1000 + 'k' }
                        },
                        x: { grid: { display: false }, ticks: { color: '#4b5563' } }
                    }
                }
            });
        }

        // Listen for changes
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', calculate);
        });

        // Initial build
        calculate();
    </script>
</body>
</html>
